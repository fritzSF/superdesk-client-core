<div class="sd-page__flex-helper">
    <div class="sd-page__header">
        <span class="sd-page__element-grow"></span>
        <button class="btn btn--primary" ng-click="edit({})">
            <i class="icon-plus-sign icon--white"></i><span translate>Add New</span>
        </button>
    </div>
    <div class="sd-page__content">
        <ul class="sd-list-item-group sd-list-item-group--space-between-items" style="max-width: 1000px;">
            <li ng-repeat="scheme in schemes" class="sd-list-item sd-shadow--z1">
                <div class="sd-list-item__border"></div>
                <div class="sd-list-item__column sd-list-item__column--grow sd-list-item__column--no-border">
                    <div class="sd-list-item__row">
                        <span class="sd-overflow-ellipsis sd-list-item--element-grow">{{scheme.name}}</span>
                    </div>
                </div>
                <div class="sd-list-item__action-menu sd-list-item__action-menu--direction-row">
                    <button class="icn-btn" ng-click="edit(scheme)" title="{{:: 'Edit scheme' | translate }}"><i class="icon-pencil"></i></button>
                    <button class="icn-btn" ng-click="remove(scheme)" title="{{:: 'Remove scheme' | translate }}"><i class="icon-trash"></i></button>
                </div>
            </li>
        </ul>
    </div>
</div>

<!-- Modal -->
<div sd-modal data-model="editScheme" class="add-scheme-modal modal--tabs sd-wizard">
    <div class="modal__header modal__header--flex">
        <h3 class="modal__heading" translate ng-show="editScheme._id" translate>Edit Scheme</h3>
        <h3 class="modal__heading" translate ng-hide="editScheme._id" translate>Add New Scheme</h3>
        <a href="" class="icn-btn close" ng-click="cancel()"><i class="icon-close-small"></i></a>
    </div>

    <div class="modal__body">    
        <form name="schemeForm">

            <div class="modal__body-content">
                <div style="padding: 1.6rem 2rem; border-bottom: 1px solid rgba(123, 123, 123, 0.2);">
                    <div class="sd-line-input sd-line-input--boxed sd-line-input--required sd-line-input--boxed sd-line-input--no-margin">
                        <label class="sd-line-input__label" translate>Scheme name</label>
                        <input class="sd-line-input__input" type="text" class="line-input input" placeholder="{{ 'Scheme name'|translate }}" ng-model="editScheme.name" required>
                    </div>
                </div>
                
                <div>
                    <div class="content stages form-flat">
                        <div class="grid grid--padding-fix">
                            <div class="grid__item grid__item--col-5">
                                <div class="heading" translate>Scheme rules</div>
                                <div class="column">
                                    <div class="stage editable addnew" ng-if="rule">
                                        <div class="sd-line-input">
                                            <input class="sd-line-input__input" type="text" ng-model="rule.name" placeholder="{{ 'Rule name' | translate }}" required autofocus>
                                        </div>
                                    </div>

                                    <ul sd-sortrules class="pills-list" ng-if="!rule">
                                        <li ng-repeat="schemeRule in editScheme.rules" ng-class="{active: selectedRule === schemeRule}" ng-click="selectRule(schemeRule)">
                                            {{schemeRule.name}}

                                            <div class="actions">
                                                <button ng-click="editRule(schemeRule)">
                                                    <i class="icon-pencil"></i>
                                                </button>
                                                <button ng-click="removeRule(schemeRule)">
                                                    <i class="icon-trash"></i>
                                                </button>
                                            </div>
                                        </li>
                                    </ul>

                                    <button class="btn btn--primary btn--expanded" ng-if="!rule" ng-click="addRule()" ng-disabled="!editScheme.name" style="margin-top: 1.6rem;">
                                        <i class="icon-plus-sign icon--white"></i><span translate>Add New Rule</span>
                                    </button>

                                    <div class="button-toolbar" ng-if="rule">
                                        <button class="btn" ng-click="cancelRule()" translate>Cancel</button>
                                        <button class="btn btn--primary" ng-click="save()" ng-disabled="disableSchemeForm()" translate>Save</button>
                                    </div>
                                </div>
                            </div>
                            <div class="grid__item grid__item--col-7">
                                <div class="heading" translate>Scheme details</div>

                                <div class="column" ng-if="!selectedRule && !rule">
                                    <i class="icon-info-sign icon--blue"></i><span class="helper-text helper-text--after-icon">Click on a Scheme rules on the left to view details.</span>
                                </div>

                                <div class="column" ng-if="selectedRule && !rule">
                                    <div sd-ingest-routing-general data-rule="selectedRule"></div>
                                </div>

                                <div class="column" ng-if="rule">
                                    <div sd-ingest-routing-filter data-rule="rule" data-content-filters="contentFilters"></div>
                                    <div sd-ingest-routing-action data-rule="rule"></div>
                                    <div sd-ingest-routing-schedule data-rule="rule"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal__body-footer">
                <button class="btn btn--primary" ng-click="done()" translate>Done</button>
            </div>
        </form>
    </div>
</div>
<!-- END Modal -->